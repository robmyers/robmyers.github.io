<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Exploring Art Data 21 &middot; robmyers
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,900' rel='stylesheet' type='text/css'>
  <link href="/public/css/robmyers.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Slideshow -->
  <script src="/public/lightbox/js/jquery-1.11.0.min.js"></script>
  <script src="/public/lightbox/js/lightbox.min.js"></script>
  <link href="/public/lightbox/css/lightbox.css" rel="stylesheet">
</head>


  <body>

    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          robmyers
        </a>
      </h1>
      <p class="lead">"self-defined artist, writer and hacker" â€“ MakeTank</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>
      <a class="sidebar-nav-item" href="/about/">About Me</a>

      
      
        
      
        
          <a class="sidebar-nav-item" href="/abcd/">ABCD</a>
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/art-data/">Art Data</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/critique/">Critique</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/free-culture/">Free Culture</a>
        
      
        
      
        
          <a class="sidebar-nav-item" href="/glitch-aesthetics/">Glitch Aesthetics</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/shareable-readymades/">Shareable Readymades</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      

      <br>

      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>

     </nav>
    
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Exploring Art Data 21</h1>
  <span class="post-date">08 Oct 2011</span>
  <p>Now that we have a file of statistical information about the folder of images that we are examining, we can plot this using the images themselves.</p>

<p>First we need to install and load the library we will use to load the images to plot. You may need to install ImageMagickâ€™s libmagick for EBImage to install, it doesnâ€™t seem to like GraphicsMagick.</p>

<p>In Fedora run:</p>

<p><code>sudo yum install libmagick-devel</code></p>

<p>In Ubuntu run:</p>

<p><code>sudo aptitude install libmagick-dev</code></p>

<p>We can then install and load EBImage as follows:</p>

<p>`</p>

<pre><code>## source("http://bioconductor.org/biocLite.R")
## biocLite("EBImage")
library("EBImage") 
</code></pre>

<p><code>Next we declare constants to control various aspects of the plot. This includes the size of the image, the graphical properties of the elements that we are plotting, and which elements to plot.  
</code></p>

<pre><code>## The plot
#inches
plotWidth&lt;-8
plotHeight&lt;-6
plotBorder&lt;-1
innerWidth&lt;-plotWidth - (plotBorder * 2)
innerHeight&lt;-plotHeight - (plotBorder * 2)
plotBackgroundCol&lt;-rgb(0.4, 0.4, 0.4, 1.0)
## Thumbnail images
thumbnailWidth&lt;-0.3
## Lines
lineWidth&lt;-1
lineCol&lt;-rgb(0.8, 0.8, 0.8, 1.0)
## Points
## This is the point scale factor (cex)
pointSize&lt;-2
pointStyle&lt;-19
pointCol&lt;-rgb(0.8, 0.8, 0.8, 1.0)
## Labels
## The label scale factor (cex)
labelSize&lt;-0.25
labelCol&lt;-rgb(1.0, 1.0, 1.0, 1.0)
## Axes
axisLabelX&lt;-""
axisLabelY&lt;-""
axisCol&lt;-rgb(1.0, 1.0, 1.0, 1.0)
## Number of significant digits to round fractional part of each tick value to
axisRoundDigits&lt;-3
## What to draw
shouldDrawImages&lt;-TRUE
shouldDrawPoints&lt;-TRUE
shouldDrawLines&lt;-TRUE
shouldDrawLabels&lt;-TRUE
shouldDrawAxes&lt;-TRUE 
</code></pre>

<p>`Then we declare variables and functions that will be used to process the data in order to fit its values into the plot in a visually appealing way.</p>

<p>`</p>

<pre><code>minXValue&lt;-NULL
maxXValue&lt;-NULL
minYValue&lt;-NULL
maxYValue&lt;-NULL
scaleX&lt;-NULL
scaleY&lt;-NULL
## Update the scaling factor for positioning images
updateXYScale&lt;-function(){
rangeX&lt;&lt;-maxXValue - minXValue
scaleX&lt;&lt;-innerWidth / rangeX
rangeY&lt;&lt;-maxYValue - minYValue
scaleY&lt;&lt;-innerHeight / rangeY
}
scaleXValue&lt;-function(x){
plotBorder + ((x - minXValue) * scaleX)
}
scaleYValue&lt;-function(y){
plotBorder + ((y - minYValue) * scaleY)
}
## Set the range of the X and Y axes for positioning images
setMinMaxXYValues&lt;-function(xMin, yMin, xMax, yMax){
minXValue&lt;&lt;-xMin
maxXValue&lt;&lt;-xMax
minYValue&lt;&lt;-yMin
maxYValue&lt;&lt;-yMax
updateXYScale()
}
## Calculate the range of the X and Y axes for positioning images
discoverMinMaxXYValues&lt;-function(xValues, yValues){
xRange&lt;-range(xValues)
yRange&lt;-range(yValues)
## Handle 0..1 or a..b
if(xRange[2] - xRange[1] &gt; 1){
xRange&lt;-c(floor(xRange[1]), ceiling(xRange[2]))
} else {
xRange&lt;-c(floor(xRange[1] * 1000) / 1000, ceiling(xRange[2] * 1000) / 1000)
}
if(yRange[2] - yRange[1] &gt; 1){
yRange&lt;-c(floor(yRange[1]), ceiling(yRange[2]))
} else {
yRange&lt;-c(floor(yRange[1] * 1000) / 1000, ceiling(yRange[2] * 1000) / 1000)
}
## Floor and ceiling the values to round them to the nearest integers
## and make the values on the plot nicer
setMinMaxXYValues(xRange[1], yRange[1], xRange[2], yRange[2])
}
## Left X value for image
## image parameter accepted to give these calls a regular signature
imageXLeft&lt;-function(image, valueX){
valueX
}
## Right X value for image
## image parameter accepted to give these calls a regular signature
imageXRight&lt;-function(image, valueX){
valueX + thumbnailWidth
}
## Get the height of the image scaled to the new width
imageHeightScaled&lt;-function(image, scaledWidth){
scale&lt;-dim(image)[1] / scaledWidth
dim(image)[2] / scale
}
## Bottom Y value for image
imageYBottom&lt;-function(image, valueY){
valueY - imageHeightScaled(image, thumbnailWidth)
}
## Top Y value for image
imageYTop&lt;-function(image, valueY){
valueY
} 
</code></pre>

<p>`The labels for
each image, the points marking the imageâ€™s position, the lines connecting each image, and the top left of each image are positioned on the x, y co-ordinates for the imageâ€™s properties being plotted.</p>

<p>Centering the image on the x, y co-ordinates might be more natural but it would obscure the position of the point and the connecting lines if they were also drawn.</p>

<p>`</p>

<pre><code>plotLabels&lt;-function(labelValues, xValues, yValues){
## Position the labels underneath the images
text(xValues, yValues, labelValues, col=labelCol, cex=labelSize, pos=3)&lt;br&gt;&lt;/br&gt;}&lt;br&gt;&lt;/br&gt;
</code></pre>

<p>``</p>

<pre><code>plotImages&lt;-function(imageFilePaths, xValues, yValues){
for(i in 1:length(imageFilePaths)){
image&lt;-readImage(imageFilePaths[i])
x&lt;-xValues[i]
y&lt;-yValues[i]
## Does the image really have to be rotated???
rasterImage(rotate(image), imageXLeft(image, x), imageYTop(image, y),
imageXRight(image, x), imageYBottom(image, y))
}
} &lt;br&gt;&lt;/br&gt;&lt;br&gt;&lt;/br&gt;
</code></pre>

<p><code>When we plot the axes their tick values are auto-generated from the value ranges, so they may look weird.  
</code></p>

<pre><code>plotAxes&lt;-function(){
xat&lt;-round(seq(minXValue, maxXValue,
(maxXValue - minXValue) / plotWidth),
axisRoundDigits)
axis(1, 0:plotWidth, xat, col=axisCol, col.ticks=axisCol, col.axis=axisCol)
yat&lt;-round(seq(minYValue, maxYValue,
(maxYValue - minYValue) / plotHeight),
axisRoundDigits)
axis(2, 0:plotHeight, yat, col=axisCol, col.ticks=axisCol, col.axis=axisCol)
} 
</code></pre>

<p><code>Having written functions to plot each element, we declare an all-in-one function to plot everything that is enabled in the configuration constants above.  
</code></p>

<pre><code>plotElements&lt;-function(imageFilePaths, xValues, yValues, labelValues){
if(shouldDrawLines){
lines(xValues, yValues, col=lineCol, lwd=lineWidth)
}
if(shouldDrawPoints){
points(xValues, yValues, pch=pointStyle, col=pointCol)
}
if(shouldDrawImages){
plotImages(imageFilePaths, xValues, yValues)
}
if(shouldDrawLabels){
plotLabels(labelValues, xValues, yValues)
}
if(shouldDrawAxes){
plotAxes()
}
}
</code></pre>

<p><code>
Then we declare a function to get the values from the data frame and call the plot-everything function.  
</code></p>

<pre><code>setValuesAndPlot&lt;-function(data, imageFilepaths, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
## Get the lists for the data columns, get the doubles from them,
## and scale to the plot
xValues&lt;-data[xColumn][,1]
yValues&lt;-data[yColumn][,1]
if(discoverRange){
discoverMinMaxXYValues(xValues, yValues)
}
scaledXValues&lt;-sapply(xValues, scaleXValue)
scaledYValues&lt;-sapply(yValues, scaleYValue)
axisLabelX&lt;&lt;-xColumn
axisLabelY&lt;&lt;-yColumn
plotElements(imageFilepaths, scaledXValues, scaledYValues, data[,labelColumn])
title(xlab=xColumn, ylab=yColumn, col.lab=axisCol)
} 
</code></pre>

<p><code>You'll notice each function is combining and building on earlier functions. Functions should be short, readable, organizing units. The next one that we declare reads the data file and the image files, and then plots the values.</code></p>

<pre><code>&lt;br&gt;&lt;/br&gt;readAndPlot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
data&lt;-read.delim(dataFile, stringsAsFactors=FALSE)
imageFilepaths&lt;-sapply(data["filename"],
function(filename) file.path(imageFolder, filename))
setValuesAndPlot(data, imageFilepaths, xColumn, yColumn, labelColumn,
discoverRange)
}
</code></pre>

<p><code>
The next function makes a new R plot with the proper graphics parameters
Notably this sets the bounds and background colour.  
</code></p>

<pre><code>newPlot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
## Call before plot.new()
par(bg=plotBackgroundCol)
plot.new()
## Use co-ordinates relative to the bounds
par(usr=c(0, plotWidth, 0, plotHeight))
par(bty="n")
readAndPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn,
discoverRange)
}
</code></pre>

<p><code>
Finally we can declare functions to plot to various different kinds of R devices. X11 for screen display and testing, PNG for embedding in web pages and documents, and PDF for high-quality output. Note that the PDF will include all the images plotted, and so it will become very large very quickly. A high-resolution PNG will be more practical for very large imagesets.  
</code></p>

<pre><code>## Make a new X11 plot
X11Plot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
X11(width=plotWidth, height=plotHeight)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
}
## Make a new PNG plot
pngPlot&lt;-function(outFile, dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE, dpi=600){
png(filename=outFile, width=plotWidth, height=plotHeight, units="in",
res=dpi)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
dev.off()
}
## Make a new PDF plot
pdfPlot&lt;-function(outFile, dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
pdf(file=outFile, width=plotWidth, height=plotHeight)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
dev.off()
} 
</code></pre>

<p>`Calling these image generating commands from the REPL in Emacs or on the command line means that we can see the output and modify the constants we declared at the start and the parameters that we pass to the image plotting functions in order to modify and improve the results interactively.</p>

<p>Running:<br />
`</p>

<pre><code>X11Plot("images.txt", "images", "brightness_median", "saturation_stdev") 
</code></pre>

<p>`Gives us:</p>

<p><a href="/assets_c/2011/09/r_image-57.html"><img src="/assets_c/2011/09/r_image-thumb-500x392-57.png" alt="Mondrian Visualization" /></a>Next we can wrap the functions we have written in command-line and GUI interfaces and explore the strengths and weaknesses of each.</p>


</div>

<ul class="share-buttons">
  <li><a href="https://www.reddit.com/r/robmyers/submit?url=https://robmyers.org/2011/10/08/exploring_art_data_21/&title=Exploring Art Data 21" target="_blank" title="Submit to Reddit"><img src="/public/flat_web_icon_set/black/Reddit.png"></a></li>
  <li><a href="https://twitter.com/intent/tweet?source=https://robmyers.org/2011/10/08/exploring_art_data_21/&text=Exploring Art Data 21:%20https://robmyers.org/2011/10/08/exploring_art_data_21/&via=robmyers" target="_blank" title="Tweet"><img src="/public/flat_web_icon_set/black/Twitter.png"></a></li>
  <li><a href="https://wordpress.com/press-this.php?u=https://robmyers.org/2011/10/08/exploring_art_data_21/&t=Exploring Art Data 21" target="_blank" title="Publish on WordPress"><img src="/public/flat_web_icon_set/black/Wordpress.png"></a></li>
  <li><a href="https://www.tumblr.com/share?v=3&u=https://robmyers.org/2011/10/08/exploring_art_data_21/&t=Exploring Art Data 21&s=" target="_blank" title="Post to Tumblr"><img src="/public/flat_web_icon_set/black/Tumblr.png"></a></li>
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://robmyers.org/2011/10/08/exploring_art_data_21/&t=Exploring Art Data 21" title="Share on Facebook" target="_blank"><img src="/public/flat_web_icon_set/black/Facebook.png"></a></li>
  <li><a href="mailto:?subject=Exploring Art Data 21&body=https://robmyers.org/2011/10/08/exploring_art_data_21/" target="_blank" title="Email"><img src="/public/flat_web_icon_set/black/Email.png"></a></li>
</ul>


<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/06/11/trying-jekyll/">
            Trying Jekyll
            <small>11 Jun 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/05/01/my-little-penny-bitcoin-is-magic/">
            My Little Penny - Bitcoin Is Magic
            <small>01 May 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/02/05/art-for-algorithms/">
            Art For Algorithms
            <small>05 Feb 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
