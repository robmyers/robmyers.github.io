<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
    robmyers &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,900' rel='stylesheet' type='text/css'>
  <link href="/public/css/robmyers.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Slideshow -->
  <script src="/public/lightbox/js/jquery-1.11.0.min.js"></script>
  <script src="/public/lightbox/js/lightbox.min.js"></script>
  <link href="/public/lightbox/css/lightbox.css" rel="stylesheet">
</head>


  <body>

    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          robmyers
        </a>
      </h1>
      <p class="lead">"self-defined artist, writer and hacker" – MakeTank</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>
      <a class="sidebar-nav-item" href="/about/">About Me</a>

      
      
        
      
        
          <a class="sidebar-nav-item" href="/abcd/">ABCD</a>
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/art-data/">Art Data</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/critique/">Critique</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/free-culture/">Free Culture</a>
        
      
        
      
        
          <a class="sidebar-nav-item" href="/glitch-aesthetics/">Glitch Aesthetics</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a class="sidebar-nav-item" href="/shareable-readymades/">Shareable Readymades</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      

      <br>

      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>

     </nav>
    
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/10/08/the_destiny_of_virus-infected_drones/">
        The Destiny Of Virus-Infected Drones
      </a>
    </h1>

    <span class="post-date">08 Oct 2011</span>

    <p><a href="http://churchofcyberpunk.tumblr.com/post/11147180129">http://churchofcyberpunk.tumblr.com/post/11147180129</a></p>

<p>Once drones are infected by botnets the criminal gangs who make money by leasing out time on infected machines will have the effect of bringing military drone sorties into the market. As we all know, state monopolies are bad because they prevent the market efficiently allocating resources within society, and armies are the state monopoly on violence. Once drones are subjected to the logic of the market, their correct price will be assigned and their true value revealed.</p>

<p>Expat-funded terrorist groups will be able to bid higher than Guardianista “anti-war-crimes” drives for other people’s money, but in the end they will lose out to spammers. Drones, those avatars of thanatos, will become heralds of eros - flying pornbots broadcasting advertisements for viagra and cialis…</p>

<p>(Via netbehaviour, and with thanks to Dave Miller.)</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/10/08/exploring_art_data_21/">
        Exploring Art Data 21
      </a>
    </h1>

    <span class="post-date">08 Oct 2011</span>

    <p>Now that we have a file of statistical information about the folder of images that we are examining, we can plot this using the images themselves.</p>

<p>First we need to install and load the library we will use to load the images to plot. You may need to install ImageMagick’s libmagick for EBImage to install, it doesn’t seem to like GraphicsMagick.</p>

<p>In Fedora run:</p>

<p><code>sudo yum install libmagick-devel</code></p>

<p>In Ubuntu run:</p>

<p><code>sudo aptitude install libmagick-dev</code></p>

<p>We can then install and load EBImage as follows:</p>

<p>`</p>

<pre><code>## source("http://bioconductor.org/biocLite.R")
## biocLite("EBImage")
library("EBImage") 
</code></pre>

<p><code>Next we declare constants to control various aspects of the plot. This includes the size of the image, the graphical properties of the elements that we are plotting, and which elements to plot.  
</code></p>

<pre><code>## The plot
#inches
plotWidth&lt;-8
plotHeight&lt;-6
plotBorder&lt;-1
innerWidth&lt;-plotWidth - (plotBorder * 2)
innerHeight&lt;-plotHeight - (plotBorder * 2)
plotBackgroundCol&lt;-rgb(0.4, 0.4, 0.4, 1.0)
## Thumbnail images
thumbnailWidth&lt;-0.3
## Lines
lineWidth&lt;-1
lineCol&lt;-rgb(0.8, 0.8, 0.8, 1.0)
## Points
## This is the point scale factor (cex)
pointSize&lt;-2
pointStyle&lt;-19
pointCol&lt;-rgb(0.8, 0.8, 0.8, 1.0)
## Labels
## The label scale factor (cex)
labelSize&lt;-0.25
labelCol&lt;-rgb(1.0, 1.0, 1.0, 1.0)
## Axes
axisLabelX&lt;-""
axisLabelY&lt;-""
axisCol&lt;-rgb(1.0, 1.0, 1.0, 1.0)
## Number of significant digits to round fractional part of each tick value to
axisRoundDigits&lt;-3
## What to draw
shouldDrawImages&lt;-TRUE
shouldDrawPoints&lt;-TRUE
shouldDrawLines&lt;-TRUE
shouldDrawLabels&lt;-TRUE
shouldDrawAxes&lt;-TRUE 
</code></pre>

<p>`Then we declare variables and functions that will be used to process the data in order to fit its values into the plot in a visually appealing way.</p>

<p>`</p>

<pre><code>minXValue&lt;-NULL
maxXValue&lt;-NULL
minYValue&lt;-NULL
maxYValue&lt;-NULL
scaleX&lt;-NULL
scaleY&lt;-NULL
## Update the scaling factor for positioning images
updateXYScale&lt;-function(){
rangeX&lt;&lt;-maxXValue - minXValue
scaleX&lt;&lt;-innerWidth / rangeX
rangeY&lt;&lt;-maxYValue - minYValue
scaleY&lt;&lt;-innerHeight / rangeY
}
scaleXValue&lt;-function(x){
plotBorder + ((x - minXValue) * scaleX)
}
scaleYValue&lt;-function(y){
plotBorder + ((y - minYValue) * scaleY)
}
## Set the range of the X and Y axes for positioning images
setMinMaxXYValues&lt;-function(xMin, yMin, xMax, yMax){
minXValue&lt;&lt;-xMin
maxXValue&lt;&lt;-xMax
minYValue&lt;&lt;-yMin
maxYValue&lt;&lt;-yMax
updateXYScale()
}
## Calculate the range of the X and Y axes for positioning images
discoverMinMaxXYValues&lt;-function(xValues, yValues){
xRange&lt;-range(xValues)
yRange&lt;-range(yValues)
## Handle 0..1 or a..b
if(xRange[2] - xRange[1] &gt; 1){
xRange&lt;-c(floor(xRange[1]), ceiling(xRange[2]))
} else {
xRange&lt;-c(floor(xRange[1] * 1000) / 1000, ceiling(xRange[2] * 1000) / 1000)
}
if(yRange[2] - yRange[1] &gt; 1){
yRange&lt;-c(floor(yRange[1]), ceiling(yRange[2]))
} else {
yRange&lt;-c(floor(yRange[1] * 1000) / 1000, ceiling(yRange[2] * 1000) / 1000)
}
## Floor and ceiling the values to round them to the nearest integers
## and make the values on the plot nicer
setMinMaxXYValues(xRange[1], yRange[1], xRange[2], yRange[2])
}
## Left X value for image
## image parameter accepted to give these calls a regular signature
imageXLeft&lt;-function(image, valueX){
valueX
}
## Right X value for image
## image parameter accepted to give these calls a regular signature
imageXRight&lt;-function(image, valueX){
valueX + thumbnailWidth
}
## Get the height of the image scaled to the new width
imageHeightScaled&lt;-function(image, scaledWidth){
scale&lt;-dim(image)[1] / scaledWidth
dim(image)[2] / scale
}
## Bottom Y value for image
imageYBottom&lt;-function(image, valueY){
valueY - imageHeightScaled(image, thumbnailWidth)
}
## Top Y value for image
imageYTop&lt;-function(image, valueY){
valueY
} 
</code></pre>

<p>`The labels for
each image, the points marking the image’s position, the lines connecting each image, and the top left of each image are positioned on the x, y co-ordinates for the image’s properties being plotted.</p>

<p>Centering the image on the x, y co-ordinates might be more natural but it would obscure the position of the point and the connecting lines if they were also drawn.</p>

<p>`</p>

<pre><code>plotLabels&lt;-function(labelValues, xValues, yValues){
## Position the labels underneath the images
text(xValues, yValues, labelValues, col=labelCol, cex=labelSize, pos=3)&lt;br&gt;&lt;/br&gt;}&lt;br&gt;&lt;/br&gt;
</code></pre>

<p>``</p>

<pre><code>plotImages&lt;-function(imageFilePaths, xValues, yValues){
for(i in 1:length(imageFilePaths)){
image&lt;-readImage(imageFilePaths[i])
x&lt;-xValues[i]
y&lt;-yValues[i]
## Does the image really have to be rotated???
rasterImage(rotate(image), imageXLeft(image, x), imageYTop(image, y),
imageXRight(image, x), imageYBottom(image, y))
}
} &lt;br&gt;&lt;/br&gt;&lt;br&gt;&lt;/br&gt;
</code></pre>

<p><code>When we plot the axes their tick values are auto-generated from the value ranges, so they may look weird.  
</code></p>

<pre><code>plotAxes&lt;-function(){
xat&lt;-round(seq(minXValue, maxXValue,
(maxXValue - minXValue) / plotWidth),
axisRoundDigits)
axis(1, 0:plotWidth, xat, col=axisCol, col.ticks=axisCol, col.axis=axisCol)
yat&lt;-round(seq(minYValue, maxYValue,
(maxYValue - minYValue) / plotHeight),
axisRoundDigits)
axis(2, 0:plotHeight, yat, col=axisCol, col.ticks=axisCol, col.axis=axisCol)
} 
</code></pre>

<p><code>Having written functions to plot each element, we declare an all-in-one function to plot everything that is enabled in the configuration constants above.  
</code></p>

<pre><code>plotElements&lt;-function(imageFilePaths, xValues, yValues, labelValues){
if(shouldDrawLines){
lines(xValues, yValues, col=lineCol, lwd=lineWidth)
}
if(shouldDrawPoints){
points(xValues, yValues, pch=pointStyle, col=pointCol)
}
if(shouldDrawImages){
plotImages(imageFilePaths, xValues, yValues)
}
if(shouldDrawLabels){
plotLabels(labelValues, xValues, yValues)
}
if(shouldDrawAxes){
plotAxes()
}
}
</code></pre>

<p><code>
Then we declare a function to get the values from the data frame and call the plot-everything function.  
</code></p>

<pre><code>setValuesAndPlot&lt;-function(data, imageFilepaths, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
## Get the lists for the data columns, get the doubles from them,
## and scale to the plot
xValues&lt;-data[xColumn][,1]
yValues&lt;-data[yColumn][,1]
if(discoverRange){
discoverMinMaxXYValues(xValues, yValues)
}
scaledXValues&lt;-sapply(xValues, scaleXValue)
scaledYValues&lt;-sapply(yValues, scaleYValue)
axisLabelX&lt;&lt;-xColumn
axisLabelY&lt;&lt;-yColumn
plotElements(imageFilepaths, scaledXValues, scaledYValues, data[,labelColumn])
title(xlab=xColumn, ylab=yColumn, col.lab=axisCol)
} 
</code></pre>

<p><code>You'll notice each function is combining and building on earlier functions. Functions should be short, readable, organizing units. The next one that we declare reads the data file and the image files, and then plots the values.</code></p>

<pre><code>&lt;br&gt;&lt;/br&gt;readAndPlot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
data&lt;-read.delim(dataFile, stringsAsFactors=FALSE)
imageFilepaths&lt;-sapply(data["filename"],
function(filename) file.path(imageFolder, filename))
setValuesAndPlot(data, imageFilepaths, xColumn, yColumn, labelColumn,
discoverRange)
}
</code></pre>

<p><code>
The next function makes a new R plot with the proper graphics parameters
Notably this sets the bounds and background colour.  
</code></p>

<pre><code>newPlot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
## Call before plot.new()
par(bg=plotBackgroundCol)
plot.new()
## Use co-ordinates relative to the bounds
par(usr=c(0, plotWidth, 0, plotHeight))
par(bty="n")
readAndPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn,
discoverRange)
}
</code></pre>

<p><code>
Finally we can declare functions to plot to various different kinds of R devices. X11 for screen display and testing, PNG for embedding in web pages and documents, and PDF for high-quality output. Note that the PDF will include all the images plotted, and so it will become very large very quickly. A high-resolution PNG will be more practical for very large imagesets.  
</code></p>

<pre><code>## Make a new X11 plot
X11Plot&lt;-function(dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
X11(width=plotWidth, height=plotHeight)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
}
## Make a new PNG plot
pngPlot&lt;-function(outFile, dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE, dpi=600){
png(filename=outFile, width=plotWidth, height=plotHeight, units="in",
res=dpi)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
dev.off()
}
## Make a new PDF plot
pdfPlot&lt;-function(outFile, dataFile, imageFolder, xColumn, yColumn,
labelColumn="filename", discoverRange=TRUE){
pdf(file=outFile, width=plotWidth, height=plotHeight)
newPlot(dataFile, imageFolder, xColumn, yColumn, labelColumn, discoverRange)
dev.off()
} 
</code></pre>

<p>`Calling these image generating commands from the REPL in Emacs or on the command line means that we can see the output and modify the constants we declared at the start and the parameters that we pass to the image plotting functions in order to modify and improve the results interactively.</p>

<p>Running:<br />
`</p>

<pre><code>X11Plot("images.txt", "images", "brightness_median", "saturation_stdev") 
</code></pre>

<p>`Gives us:</p>

<p><a href="/assets_c/2011/09/r_image-57.html"><img src="/assets_c/2011/09/r_image-thumb-500x392-57.png" alt="Mondrian Visualization" /></a>Next we can wrap the functions we have written in command-line and GUI interfaces and explore the strengths and weaknesses of each.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/10/08/balloon_dog/">
        Balloon Dog
      </a>
    </h1>

    <span class="post-date">08 Oct 2011</span>

    <p>My 3D printing art project “<a href="http://www.furtherfield.org/projects/balloon-dog-rob-myers">Balloon Dog</a>” is now available as part of <a href="http://www.artscouncil.org.uk/about-us/digital-innovation-development/thinking-digital/collaboration-and-freedom/">Collaboration and Freedom - The World of Free and Open Source Art</a>. <a href="http://www.furtherfield.org/projects/balloon-dog-rob-myers">Furtherfield</a> commissioned it as a sequel to <a href="/art/urinal/">Urinal</a>.</p>

<p><img src="/assets/balloon_dog2.png" alt="balloon_dog2.png" />The model was created by Bassam Kurdali, and it’s available under a Creative Commons Attrubution-ShareAlike 3.0 unported licence (as with Urinal’s modeller Chris Webber, Bassam holds the copyright on the model).</p>

<p>I submitted it to <a href="http://boingboing.net/2011/09/21/uk-free-and-open-source-art-exhibit.html">Boing Boing</a> and <a href="http://www.thingiverse.com/thing:11830">Thingiverse</a>, where there have been some interesting comments, and is already being used for purposes other than 3D printing, which is great to see.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/10/08/artbollocks-modeel/">
        artbollocks-mode.el
      </a>
    </h1>

    <span class="post-date">08 Oct 2011</span>

    <p>I turned the scripts I use for avoiding various cardinal sins of art
writing into an Emacs minor mode. This means that you can run it in your Emacs session as you write.</p>

<p>What do you mean you don’t use Emacs? Don’t be silly. ;-)</p>

<p><a href="https://gitorious.org/robmyers/scripts/blobs/master/artbollocks-mode.el">https://gitorious.org/robmyers/scripts/blobs/master/artbollocks-mode.el</a></p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/10/02/exploring_art_data_20/">
        Exploring Art Data 20
      </a>
    </h1>

    <span class="post-date">02 Oct 2011</span>

    <p>[Exploring Art Data 18 and 19 concern parsing and charting the Graves Art Sales data covering Constable. They will be published later.]</p>

<p>Let’s reproduce the functionality of <a href="http://lab.softwarestudies.com/2011/09/introducing-imageplot-software-explore.html">ImagePlot</a> in R . We’ll do this in several stages. In this post we’ll write code to produce statistical information about collections of image files. In the next post we’ll write code to visualize that information. Then we’ll write command line and graphical user interface code for the visualization. Finally we’ll use the command line code to look at how to perform image analysis distributed over the network.</p>

<p>For the statistical analysis code (<code>image-properties.r</code>), first we’ll need to install and load some libraries:</p>

<pre><code>&lt;code&gt;## source("http://bioconductor.org/biocLite.R")
## biocLite("EBImage")
## You may need to install libmagick for EBImage
library("EBImage")
##install.packages("colorspace")
library("colorspace")
&lt;/code&gt;
</code></pre>

<p>Then we will need to write code to convert from the computer-friendly RGB colourspace to the human-friendly HSB colourspace.</p>

<pre><code>&lt;code&gt;
## Get the r,g,b colour values for all the pixels in the image as a list
imageRgbs&lt;-function(bitmap){
## Get flat lists of red, green and blue pixel values
red&lt;-imageData(channel(bitmap, "red"))
dim(red)&lt;-NULL
green&lt;-imageData(channel(bitmap, "green"))
dim(green)&lt;-NULL
blue&lt;-imageData(channel(bitmap, "blue"))
dim(blue)&lt;-NULL
## Combine these lists into a table of pixel r,g,b values
data.frame(red=red, green=green,blue=blue)
}
## Convert the RGB data.frame to an RGB objects collection
rgbToHsv&lt;-function(rgbs){
as(RGB(rgbs$red, rgbs$green, rgbs$blue), "HSV")
}
&lt;/code&gt;
</code></pre>

<p>Next we write the code to produce the statistics for each image. R makes this very easy.</p>

<pre><code>&lt;code&gt;
## Calculate the median values for the HSV coordinates
## The colour returned is not a colour in the image,
## it just contains the median values
medianHsv&lt;-function(hsvcoords){
HSV(median(hsvcoords[,"H"]), median(hsvcoords[,"S"]), median(hsvcoords[,"V"]))
}
## Calculate the minimum and maximum values for the HSV coordinates
## Returns a vector of colours, the first containing low values,
## the second containing high values
## These are not colours that appear in the image, they just contain the values
rangeHsv&lt;-function(hsvcoords){
hrange&lt;-range(hsvcoords[,"H"])
srange&lt;-range(hsvcoords[,"S"])
vrange&lt;-range(hsvcoords[,"V"])
c(min=HSV(hrange[1], srange[1], vrange[1]),
max=HSV(hrange[2], srange[2], vrange[2]))
}
## Calculate the standard deviation for the HSV coordinates
## The colour returned is not a colour in the image,
## it just contains the sd for each value
sdHsv&lt;-function(hsvcoords){
hsd&lt;-sd(hsvcoords[,"H"])
ssd&lt;-sd(hsvcoords[,"S"])
vsd&lt;-sd(hsvcoords[,"V"])
HSV(hsd[1], ssd[1], vsd[1])
}
## A good way of getting the min, max, median and other useful values
summaryHsv&lt;-function(hsvcoords){
list(H=summary(hsvcoords[,"H"]),
S=summary(hsvcoords[,"S"]),
V=summary(hsvcoords[,"V"]))
}
&lt;/code&gt;
</code></pre>

<p>Now we write the code to output those statistics. This is slightly more complex than the simplest possible way of structuring the code would be in order to make the code more robust if we need to change it later.</p>

<pre><code>&lt;code&gt;
## HSV == HSB
## We use brightness for compatibility
## Some columns and column names are also for compatibility
## Load the file and return a vector of named interesting statistics
fileRow&lt;-function(filename){
cat(filename, sep="\n")
img&lt;-readImage(filename)
rgbs&lt;-imageRgbs(img)
hsvs&lt;-rgbToHsv(rgbs)
hsvcoords&lt;-coords(hsvs)
summaryhsv&lt;-summaryHsv(hsvcoords)
sdhsv&lt;-sdHsv(hsvcoords)
sdhsvcoords&lt;-coords(sdhsv)
## NaN for year for now
c("year"=NaN,
## Get the values manually so that we don't rely on position in case
## that ever changes
"hue_min"=summaryhsv$H[["Min."]],
"hue_1st_qu"=summaryhsv$H[["1st Qu."]],
"hue_median"=summaryhsv$H[["Median"]],
"hue_mean"=summaryhsv$H[["Mean"]],
"hue_3rd_qu"=summaryhsv$H[["3rd Qu."]],
"hue_max"=summaryhsv$H[["Max."]],
"hue_stdev"=sdhsvcoords[,"H"][[1]], ## There must be a better way than this
"saturation_min"=summaryhsv$S[["Min."]],
"saturation_1st_qu"=summaryhsv$S[["1st Qu."]],
"saturation_median"=summaryhsv$S[["Median"]],
"saturation_mean"=summaryhsv$S[["Mean"]],
"saturation_3rd_qu"=summaryhsv$S[["3rd Qu."]],
"saturation_max"=summaryhsv$S[["Max."]],
"saturation_stdev"=sdhsvcoords[,"S"][[1]],
"brightness_min"=summaryhsv$V[["Min."]],
"brightness_1st_qu"=summaryhsv$V[["1st Qu."]],
"brightness_median"=summaryhsv$V[["Median"]],
"brightness_mean"=summaryhsv$V[["Mean"]],
"brightness_3rd_qu"=summaryhsv$V[["3rd Qu."]],
"brightness_max"=summaryhsv$V[["Max."]],
"brightness_stdev"=sdhsvcoords[,"V"][[1]])
}
## Create a frame containing interesting information about the images
filesSummaries&lt;-function(filenames, folder){
cat("Processing: ")
cat(filenames, sep=", ")
filepaths&lt;-sapply(filenames,
function(filename) file.path(folder, filename))
## data.frame columns can be different types, so we add the filenames here
## We don't have the strings as factors as if we paste() them as factors
## they are pasted as numbers (levels)
data.frame(filename=filenames,
imageID=1:length(filenames),
t(sapply(filepaths, fileRow)), stringsAsFactors=FALSE)
}
## Print the fileDetails frame to a tab-separated-values file
## This can easily be loaded back into R
printFilesSummaries&lt;-function(fileDetails, outfile=""){
## Build an array of values for the file images,
## and make it a frame with the filenames as a column
cat(paste(names(fileDetails), collapse="\t"), file=outfile)
cat("\n", file=outfile)
for(row in 1:dim(fileDetails)[1]){
cat(paste(fileDetails[row,], collapse="\t"), file=outfile)
cat("\n", file=outfile)
}
cat("Done.", sep="\n")
}
&lt;/code&gt;
</code></pre>

<p>This code can be run from an interactive R session. For scripting and distribution it can be convenient to have a command-line interface to the code. So in another file (<code>imgstats</code>) we write a simple command-line interface to the code.</p>

<p>First of all we load the image statistics code</p>

<pre><code>&lt;code&gt;
source("image-properties.r")
&lt;/code&gt;
</code></pre>

<p>Then we parse the command line arguments and make sure that the user has provided reasonable values to the script, quitting with an advisory message if they have not.</p>

<pre><code>&lt;code&gt;
################################################################################
## Parse the command line
################################################################################
args&lt;-commandArgs(TRUE)
if(length(args) != 1){
stop(paste("usage: imgstats [foldername]"))
}
folder&lt;-args[1]
if(folder == "."){
stop("Please pass the name of the folder to process, not '.' .")
}
&lt;/code&gt;
</code></pre>

<p>Next we call the code from <code>image-properties.r</code> to process each of the files in the folder the user named as an argument to the script.</p>

<pre><code>&lt;code&gt;
################################################################################
## Process the files
################################################################################
## Add more formats to taste. We need to only load image files though
files&lt;-list.files(folder, pattern="*.(jpg|jpeg|tif|tiff|png|gif|bmp)")
stats&lt;-filesSummaries(files, folder)
&lt;/code&gt;
</code></pre>

<p>Finally we call the code from <code>image-properties.r</code> to save the data to a file (named after the folder that has been processed by the script).</p>

<pre><code>&lt;code&gt;
################################################################################
## Write the data
################################################################################
outfile&lt;-file(paste(folder, ".txt", sep=""), "w")
printFilesSummaries(stats, outfile)
close(outfile)
&lt;/code&gt;
</code></pre>

<p>To run the code from the command line we have to set its execute file permission:</p>

<pre><code>&lt;code&gt;
chmod +x imgstat
&lt;/code&gt;
</code></pre>

<p>And now we can generate statistical data about a folder of images ready to visualize.</p>

<p>Here’s an example of the output from the script:</p>

<pre><code>&lt;tt&gt;&lt;/tt&gt;filename	imageID	year	hue_min	hue_1st_qu	hue_median	hue_mean	hue_3rd_qu	hue_max	hue_stdev	saturation_min	saturation_1st_qu	saturation_median	saturation_mean	saturation_3rd_qu	saturation_max	saturation_stdev	brightness_min	brightness_1st_qu	brightness_median	brightness_mean	brightness_3rd_qu	brightness_max	brightness_stdev
1905.5_a_mondrian.jpg	1	NaN	0	51.43	55.29	60.23	65.71	330	16.5393230900438	0	0.232	0.2925	0.3066	0.3537	1	0.123994722897117	0.01176	0.2863	0.4549	0.4818	0.702	1	0.246702823821300
1905.5_b_mondrian.jpg	2	NaN	0	36	40.47	94.86	192	360	90.020405312462	0	0.1333	0.2155	0.1979	0.2581	0.7143	0.0935518755834357	0.04314	0.2	0.6118	0.5523	0.8549	0.9725	0.312092338505255
1905.5_c_mondrian.jpg	3	NaN	0	41.54	264	200.3	330	360	139.634180648185	0	0.141	0.2	0.2078	0.2644	1	0.0978851449446736	0.03137	0.08235	0.1608	0.2296	0.2667	1	0.216606346291597
1905.5_d_mondrian.jpg	4	NaN	0	32	42	76.1	67.5	360	90.4207404627883	0	0.2308	0.306	0.3256	0.4	1	0.139508165859475	0.01569	0.1176	0.2627	0.3912	0.698	1	0.296420604122761
1905.5_e_mondrian.jpg	5	NaN	0	72	124.3	135.3	217.2	345	65.5574296333988	0	0.1646	0.25	0.2706	0.3925	1	0.144880395319209	0.01569	0.2	0.3176	0.4501	0.8314	1	0.304302318390967
1905.5_f_mondrian.jpg	6	NaN	0	48	56.84	85.65	70	360	74.8812889958008	0	0.05	0.1452	0.1937	0.3438	0.8333	0.153920183168041	0.01569	0.2863	0.4353	0.4846	0.7059	0.9725	0.242587145239624
1905.5_g_mondrian.jpg	7	NaN	0	38.46	43.08	42.42	46.32	100	5.77930853730472	0	0.324	0.4706	0.4646	0.5972	1	0.164745255193285	0.01176	0.4196	0.5922	0.6044	0.8588	1	0.243507248302950
1905.5_h_mondrian.jpg	8	NaN	0	40	47.14	54.34	60	360	25.19346977218	0	0.07547	0.1946	0.2287	0.3524	1	0.174754958215903	0.003922	0.2902	0.5882	0.5644	0.8157	0.9961	0.300666257269201
</code></pre>


  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page30">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page28">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
